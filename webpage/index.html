<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/global.css">
    <link rel="stylesheet" href="./css/navbar.css">
    <link rel="stylesheet" href="./css/content.css">
    <script src="./js/navbar.js"></script>
    <script src="./js/chartjs/chart.min.js"></script>
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.min.css" />
    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/css/fabric.components.min.css" />
    <script src="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-js/1.4.0/js/fabric.min.js"></script>
    <title>Wetteranalyse</title>
</head>
<body>
    <header>
        <div class="topnav" id="myTopnav">
            <a href="#" class="active">Forecast (LR)</a>
            <a href="./weather_forecast_knn.html">Forecast (LSTM)</a>
            <a href="./weather_acf.html">AKF</a>
            <a href="javascript:void(0);" class="icon" onclick="navbarClick()">
              <i id="topnav-icon" class="ms-Icon ms-Icon--GlobalNavButton"></i>
            </a>
        </div>
    </header>
    <div class="content-body">
        <div id="title">
            <h1>Forecast anhand von linearer Regression</h1>
        </div>
        <div class="ms-Grid" dir="ltr" style="margin-bottom: 25px;">
            <div class="ms-Grid-row">
                <div class="ms-Grid-col ms-sm6 ms-md4 ms-lg2">
                    <button onclick="startIndexScript()" class="ms-Button ms-Button--primary">
                        <span class="ms-Button-label">Start Pythonscript</span> 
                    </button>
                </div>
                <div class="ms-Grid-col ms-sm6 ms-md4 ms-lg2">
                    <div class="ms-CalloutExample">
                        <div class="ms-Callout is-hidden">
                          <div class="ms-Callout-main">
                            <div class="ms-Callout-header">
                              <p class="ms-Callout-title">Wetterdaten - Meteostat</p>
                            </div>
                            <div class="ms-Callout-inner">
                              <div class="ms-Callout-content">
                                <p class="ms-Callout-subText">Die Daten die in dieser Web-Anwendung analysiert werden k√∂nnen, wurden bei Meteostat in Form von CSV-Dateien erhoben.</p>
                              </div>
                              <div class="ms-Callout-actions">
                                <a href="https://meteostat.net/de/place/47R0P0?t=2011-01-01/2019-12-31" class="ms-Link" target="_blank">Mehr erfahren</a> 
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="ms-CalloutExample-button">
                          <button class="ms-Button">
                            <span class="ms-Button-label">Datenquelle</span> 
                          </button>
                        </div>
                    </div>
                </div>
                <div class="ms-Grid-col ms-sm6 ms-md4 ms-lg2">
                    <div class="ms-PanelExample">
                        <button id="detailPanel" class="ms-Button" disabled>
                          <span class="ms-Button-label">Analysedetails</span> 
                        </button>
                        <div class="ms-Panel ms-Panel--lg">
                          <button class="ms-Panel-closeButton ms-PanelAction-close">
                            <i class="ms-Panel-closeIcon ms-Icon ms-Icon--Cancel"></i>
                          </button>
                          <div class="ms-Panel-contentInner">
                            <p class="ms-Panel-headerText">Details der Analyse</p>
                            <div class="ms-Panel-content">
                              <span class="ms-font-m">Laufzeit, usw...</span> 
                            </div>
                          </div>
                        </div>
                    </div>
                </div>      
            </div>
            
        </div>
        <div class="chart-container">
            <div id="chart-loading-spinner" style="display: none;">
                <div class="lds-roller" id="spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
            </div>
            <canvas id="lrChart" style="display: none;"></canvas>
        </div>
    </div>
</body>
<script>
    function myFunction() {
      alert("TODO - Pythonskript schreiben");
    }
</script>
<script src="./js/sampleChart.js"></script>
<script src="./js/initFabricCore.js"></script>
<script src="./js/index.js"></script>
<html>

<!-- <head>
    <title>Projekt Algorithmen</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta charset="UTF-8">

    <script src="chartjs/chart.min.js"></script>
</head>

<body>

    <div>
        <canvas id="chart"></canvas>
    </div>

    <form class="form-inline">
        <input type="file" id="files" class="form-control" accept=".csv" required multiple />
    </form>

    <p id="test"></p>
    <script>
        // Files lesen
        var fileInput = document.querySelector("#files")
        var chart = null

        function readmultifiles(files) {
            return new Promise((resolve, reject) => {
                var reader = new FileReader();
                function readFile(index) {
                    return new Promise((resolve, reject) => {
                        if (index >= files.length) { resolve(); return };
                        var file = files[index];
                        reader.onload = async function (e) {
                            var bin = e.target.result;
                            bin += await readFile(index + 1)
                            resolve(bin)
                        }
                        reader.readAsBinaryString(file);
                    })
                }
                resolve(readFile(0))
            })
        }

        fileInput.addEventListener('change', async function () {
            if (chart != null)
                chart.clear()

            var len_files = fileInput.files.length
            var csv = await readmultifiles(fileInput.files)

            csv = csv.split("\n")

            var header = []
            var data = []

            csv.forEach((element, idx) => {
                csv[idx] = element.split(",")
            })

            csv.sort()
            csv.splice(len_files * -1)

            csv.forEach(element => {
                header.push(element[0])
                data.push(element[1])
            });

            buildChart(data, header)
        });

        var buildChart = function (dataset, label) {
            const data = {
                labels: label,
                datasets: [{
                    label: "Paderborn Durchsch. Temperatur",
                    data: dataset,
                    backgroundColor: [
                        'rgb(16, 16, 16)',
                    ]
                }]
            }

            const config = {
                type: "line",
                data: data,
            }

            chart = new Chart(
                document.getElementById("chart"),
                config
            )
        }
    </script>
</body>

</html> -->